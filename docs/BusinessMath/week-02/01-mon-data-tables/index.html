<!doctype html><html lang="en" data-bs-theme="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Part 5 of 12-Week BusinessMath Series"><meta name="author" content="Justin Purnell"><meta name="generator" content="Ignite v0.2.1"><title>Data Table Analysis for Sensitivity Testing</title><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/prism-default-dark.css" rel="stylesheet"><link href="/css/bootstrap-icons.min.css" rel="stylesheet"><link href="https://www.justinpurnell.com/BusinessMath/week-02/01-mon-data-tables" rel="canonical"><meta property="og:site_name" content="Justin Purnell"><meta property="og:title" content="Data Table Analysis for Sensitivity Testing"><meta property="twitter:title" content="Data Table Analysis for Sensitivity Testing"><meta property="og:description" content="Data Table Analysis for Sensitivity Testing"><meta name="twitter:description" content="Data Table Analysis for Sensitivity Testing"><meta property="og:url" content="https://www.justinpurnell.com/BusinessMath/week-02/01-mon-data-tables"><meta name="twitter:domain" content="justinpurnell.com"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:dnt" content="on"><meta name="description" content="**Entrepreneurial Strategist & Builder:** Justin Purnell is the Founder of **Ledge Partners**, dedicated to acquiring and leading profitable businesses. His foundation is built on seven years at **Goldman Sachs** as a high yield credit analyst, where he published over **400 research reports** and advised C-level executives.
**Product Innovation and Scale:** He led the complete **re-platforming of technology supporting over 70 e-commerce sites** globally as Head of Product at **Hotels at Home**. He actively builds technical solutions, including pioneering **AI-powered software** to automate product data generation and designing a Swift middleware prototype that cut vendor onboarding time from **four months to two weeks**.
**Driving Financial and Organizational Results:** At **NBCUniversal's Seeso**, he directed product operations and retention initiatives that resulted in a **40% increase in customer Lifetime Value**. He is adept at mobilizing cross-functional teams, having successfully stepped in to **referee a dispute** between NBC and a third-party vendor to foster consensus and launch the Content Commerce platform.
**Creative and Governance Leadership:** Justin combines corporate rigor with creative experience, having directed the Webby-awarded web series **Smart Girls at the Party** and serving as a founding producer for **UCBcomedy.com**. He maintains significant governance roles, including serving as **President of the Princeton University Class of 2000** (1,143 alumni) and managing its annual giving campaigns."><meta name="fediverse:creator" content="@jpurnell@mastodon.social"><meta name="tags" content="Product Manager, Strategy, Product Leader, Goldman Sachs, NBCUniversal, Hotels at Home, AI, LLM, Digital Transformation, e-commerce, Swift, Consensus Leadership, Leadership, Agile, DevOps, Continuous Integration, Continuous Deployment, Cloud, Data Science, Machine Learning, Python, JavaScript, Front-end, Back-end, Full-stack, Responsive Design, Accessibility, SEO, Content Strategy, User Experience, User Interface, Design, Agile, Product Strategy, Technical Strategy"><script>	(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-K3TZS8J');</script><link href="/css/main.css" rel="stylesheet"></head><body><div class="col-sm-10 mx-auto"><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K3TZS8J"
	height="0" width="0" style="display:none;visibility:hidden"></iframe>
<header><nav class="noPrint navbar navbar-expand-md" style="border-bottom: 0.01em solid #d5d5d5;"><div class="container-fluid col"><button type="button" class="navbar-toggler btn" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarCollapse" class="collapse navbar-collapse"><ul class="navbar-nav mb-2 mb-md-0 col"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/about" class="nav-link">About</a></li><li class="nav-item"><a href="/cv" class="nav-link">CV</a></li><li class="nav-item"><a href="/business-math" class="nav-link">BusinessMath</a></li><li class="nav-item"><a href="/next" class="nav-link">NeXT</a></li></ul></div></div></nav></header><div class="row"><div class="col"><h1 class="mainTitle">Data Table Analysis for Sensitivity Testing</h1><div style="margin-bottom: 2em"><p class="blogDateTime" style="margin-left: 1em">BusinessMath Quarterly Series</p><p class="blogDateTime" style="margin-left: 1em">8 min read</p></div><p class="mx-auto blurb" style="width: 70%; max-width: 800px"><p><strong>Part 5 of 12-Week BusinessMath Series</strong></p><hr /><h2>What You‚Äôll Learn</h2><ul><li>How to perform Excel-like sensitivity analysis with data tables</li><li>Creating one-variable tables to test single assumptions</li><li>Building two-variable matrices for scenario planning</li><li>Applying data tables to loans, investments, and pricing decisions</li><li>Exporting results for further analysis</li></ul><hr /><h2>The Problem</h2><p>Business decisions often require assumptions about the future. <strong>What if the interest rate rises? What if our sales volume drops? What price maximizes profit?</strong></p><p>Excel‚Äôs ‚ÄúWhat-If Analysis‚Äù tools answer these questions by systematically varying inputs and calculating outputs. But building these analyses in code often requires writing custom loops, managing nested arrays, and formatting results manually.</p><p>BusinessMath allows you to explore scenarios programmatically‚Äîto test assumptions, find break-even points, and identify optimal strategies‚Äîwithout the complexity of manual iteration.</p><hr /><h2>The Solution</h2><p>BusinessMath provides <strong>Data Tables</strong> that work just like Excel‚Äôs sensitivity analysis tools, but with Swift‚Äôs type safety and composability.</p><h3>One-Variable Analysis: Loan Payment Sensitivity</h3><p>How much will monthly payments change if interest rates rise?</p><pre><code class="language-swift">import BusinessMath

// Loan parameters
let principal = 300_000.0
let loanTerm = 360  // 30 years monthly

// Test different interest rates
let rates = Array(stride(from: 0.03, through: 0.07, by: 0.005))

// Create data table
let paymentTable = DataTable<Double, Double>.oneVariable(
    inputs: rates,
    calculate: { annualRate in
        let monthlyRate = annualRate / 12.0
        return payment(
            presentValue: principal,
            rate: monthlyRate,
            periods: loanTerm,
            futureValue: 0,
            type: .ordinary
        )
    }
)

print("Mortgage Payment Sensitivity Analysis")
print("======================================")
print("Loan Amount: \(principal.currency())")
print("Term: 30 years\n")

for (rate, monthlyPayment) in paymentTable {
    let totalPaid = monthlyPayment * Double(loanTerm)
    let totalInterest = totalPaid - principal

    print("\(round(rate * 1000)/10)%\t\t\(monthlyPayment.currency())\t\t\(totalInterest.currency())")
}
</code></pre><p><strong>Output:</strong></p><pre><code>Mortgage Payment Sensitivity Analysis
======================================
Loan Amount: $300,000.00
Term: 30 years

3.0%		$1,264.81		$155,332.36
3.5%		$1,347.13		$184,968.26
4.0%		$1,432.25		$215,608.52
4.5%		$1,520.06		$247,220.13
5.0%		$1,610.46		$279,767.35
5.5%		$1,703.37		$313,212.12
6.0%		$1,798.65		$347,514.57
6.5%		$1,896.20		$382,633.47
7.0%		$1,995.91		$418,526.69
</code></pre><p><strong>The insight</strong>: A 1% rate increase (4% ‚Üí 5%) adds $178/month and $64,000 in total interest over 30 years!</p><hr /><h3>Break-Even Analysis</h3><p>At what sales volume does a business become profitable?</p><pre><code class="language-swift">// Business parameters
let fixedCosts = 50_000.0
let variableCostPerUnit = 15.0
let pricePerUnit = 25.0

// Test different sales volumes
let volumes = Array(stride(from: 1000.0, through: 10000.0, by: 1000.0))

let profitTable = DataTable<Double, Double>.oneVariable(
    inputs: volumes,
    calculate: { volume in
        let revenue = pricePerUnit * volume
        let totalCosts = fixedCosts + (variableCostPerUnit * volume)
        return revenue - totalCosts
    }
)

print("\nBreak-Even Analysis")
print("Fixed Costs: \(fixedCosts.currency())")
print("Contribution Margin: \((pricePerUnit - variableCostPerUnit).currency())/unit\n")

for (volume, profit) in profitTable {
    let status = profit >= 0 ? "‚úì" : "‚úó"
    print("\(volume.number()) units\t\(profit.currency()) \(status)")
}

// Calculate exact break-even
let breakEvenVolume = fixedCosts / (pricePerUnit - variableCostPerUnit)
print("\nBreak-Even Volume: \(breakEvenVolume.number()) units")
</code></pre><p><strong>Output:</strong></p><pre><code>Break-Even Analysis
Fixed Costs: $50,000.00
Contribution Margin: $10.00/unit

 1,000 units	($40,000.00) ‚úó
 2,000 units	($30,000.00) ‚úó
 3,000 units	($20,000.00) ‚úó
 4,000 units	($10,000.00) ‚úó
 5,000 units	$0.00 ‚úì
 6,000 units	$10,000.00 ‚úì
 7,000 units	$20,000.00 ‚úì
 8,000 units	$30,000.00 ‚úì
 9,000 units	$40,000.00 ‚úì
10,000 units	$50,000.00 ‚úì

Break-Even Volume: 5,000 units
</code></pre><hr /><h3>Two-Variable Analysis: Pricing Strategy Matrix</h3><p>What price and volume combination maximizes profit?</p><pre><code class="language-swift">// Fixed business parameters
let monthlyFixedCosts = 100_000.0
let variableCostPerUnit = 30.0

// Scenarios to test
let pricePoints = [40.0, 45.0, 50.0, 55.0, 60.0]
let volumeScenarios = [2000.0, 2500.0, 3000.0, 3500.0, 4000.0]

// Create two-variable profit matrix
let profitMatrix = DataTable<Double, Double>.twoVariable(
    rowInputs: pricePoints,
    columnInputs: volumeScenarios,
    calculate: { price, volume in
        let revenue = price * volume
        let totalCosts = monthlyFixedCosts + (variableCostPerUnit * volume)
        return revenue - totalCosts
    }
)

// Print formatted results
print("\nPricing Strategy Matrix (Monthly Profit)")

// Option 1: Use built-in formatter (simpler, basic formatting)
// let formatted = DataTable.formatTwoVariable(
//     profitMatrix,
//     rowInputs: pricePoints,
//     columnInputs: volumeScenarios
// )
// print(formatted)

// Option 2: Custom formatting with currency (shown below)
var header = "Price           "
for volume in volumeScenarios {
    header += "\(Int(volume))".paddingLeft(toLength: 14)
}
print(header)
print(String(repeating: "=", count: 70))

for (rowIndex, price) in pricePoints.enumerated() {
    var rowString = "\(price.currency())      "
    for colIndex in 0..<volumeScenarios.count {
        let profit = profitMatrix[rowIndex][colIndex]
        rowString += "\(profit.currency())  "
    }
    print(rowString)
}

// Find optimal combination
var maxProfit = -Double.infinity
var optimalPrice = 0.0
var optimalVolume = 0.0

for (rowIndex, price) in pricePoints.enumerated() {
    for (colIndex, volume) in volumeScenarios.enumerated() {
        let profit = profitMatrix[rowIndex][colIndex]
        if profit > maxProfit {
            maxProfit = profit
            optimalPrice = price
            optimalVolume = volume
        }
    }
}

print("\nOptimal Strategy:")
print("Price: \(optimalPrice.currency()), Volume: \(optimalVolume.number(0)) units")
print("Maximum Monthly Profit: \(maxProfit.currency())")
</code></pre><p><strong>Output:</strong></p><pre><code>Pricing Strategy Matrix (Monthly Profit)
Price             2000        2500        3000        3500        4000
======================================================================
$40          ($80,000)   ($75,000)   ($70,000)   ($65,000)   ($60,000)
$45          ($70,000)   ($62,500)   ($55,000)   ($47,500)   ($40,000)
$50          ($60,000)   ($50,000)   ($40,000)   ($30,000)   ($20,000)
$55          ($50,000)   ($37,500)   ($25,000)   ($12,500)          $0
$60          ($40,000)   ($25,000)   ($10,000)      $5,000     $20,000

Optimal Strategy:
Price: $60.00, Volume: 4,000 units
Maximum Monthly Profit: $20,000.00
</code></pre><p><strong>The insight</strong>: Higher prices with higher volumes yield maximum profit, but you need to validate whether demand supports both.</p><hr /><h2>How It Works</h2><h3>Type-Safe Generic Tables</h3><p>Data tables are generic over both input and output types:</p><pre><code class="language-swift">public struct DataTable<Input, Output> {
    // One-variable table: [Input] ‚Üí [Output]
    static func oneVariable(
        inputs: [Input],
        calculate: (Input) -> Output
    ) -> DataTable<Input, Output>

    // Two-variable table: [Input‚ÇÅ] √ó [Input‚ÇÇ] ‚Üí [[Output]]
    static func twoVariable(
        rowInputs: [Input],
        columnInputs: [Input],
        calculate: (Input, Input) -> Output
    ) -> [[Output]]
}
</code></pre><p>This works with any numeric type (Double, Float) and preserves type information through the calculation.</p><h3>CSV Export</h3><p>Export results for spreadsheet analysis:</p><pre><code class="language-swift">let csv = DataTable.toCSV(
    paymentTable,
    inputHeader: "Interest Rate",
    outputHeader: "Monthly Payment"
)

// Write to file
try csv.write(toFile: "loan_payments.csv", atomically: true, encoding: .utf8)
</code></pre><hr /><h2>Try It Yourself</h2><details>
<summary>Click to expand full playground code</summary>
<pre><code class="language-swift">import BusinessMath

// Loan parameters
let principal = 300_000.0
let loanTerm = 360  // 30 years monthly

// Test different interest rates
let rates = Array(stride(from: 0.03, through: 0.07, by: 0.005))

// Create data table
let paymentTable = DataTable.oneVariable(
	inputs: rates,
	calculate: { annualRate in
		let monthlyRate = annualRate / 12.0
		return payment(
			presentValue: principal,
			rate: monthlyRate,
			periods: loanTerm,
			futureValue: 0,
			type: .ordinary
		)
	}
)

print("Mortgage Payment Sensitivity Analysis")
print("======================================")
print("Loan Amount: \(principal.currency())")
print("Term: 30 years\n")

for (rate, monthlyPayment) in paymentTable {
	let totalPaid = monthlyPayment * Double(loanTerm)
	let totalInterest = totalPaid - principal

	print("\(rate.percent(1))\t\t\(monthlyPayment.currency())\t\t\(totalInterest.currency())")
}

// Business parameters
let fixedCosts_mortgagePayment = 50_000.0
let variableCostPerUnit_mortgagePayment = 15.0
let pricePerUnit_mortgagePayment = 25.0

// Test different sales volumes
let volumes = Array(stride(from: 1000.0, through: 10000.0, by: 1000.0))

let profitTable = DataTable.oneVariable(
	inputs: volumes,
	calculate: { volume in
		let revenue = pricePerUnit_mortgagePayment * volume
		let totalCosts = fixedCosts_mortgagePayment + (variableCostPerUnit_mortgagePayment * volume)
		return revenue - totalCosts
	}
)

print("\nBreak-Even Analysis")
print("Fixed Costs: \(fixedCosts_mortgagePayment.currency())")
print("Contribution Margin: \((pricePerUnit_mortgagePayment - variableCostPerUnit_mortgagePayment).currency())/unit\n")

for (volume, profit) in profitTable {
	let status = profit >= 0 ? "‚úì" : "‚úó"
	print("\(volume.number(0).paddingLeft(toLength: 6)) units\t\(profit.currency()) \(status)")
}

// Calculate exact break-even
let breakEvenVolume = fixedCosts_mortgagePayment / (pricePerUnit_mortgagePayment - variableCostPerUnit_mortgagePayment)
print("\nBreak-Even Volume: \(breakEvenVolume.number(0)) units")

	// Fixed business parameters
	let monthlyFixedCosts = 100_000.0
	let variableCostPerUnit = 30.0

	// Scenarios to test
	let pricePoints = [40.0, 45.0, 50.0, 55.0, 60.0]
	let volumeScenarios = [2000.0, 2500.0, 3000.0, 3500.0, 4000.0]

	// Create two-variable profit matrix
	let profitMatrix = DataTable<Double, Double>.twoVariable(
		rowInputs: pricePoints,
		columnInputs: volumeScenarios,
		calculate: { price, volume in
			let revenue = price * volume
			let totalCosts = monthlyFixedCosts + (variableCostPerUnit * volume)
			return revenue - totalCosts
		}
	)

	// Print formatted results
	print("\nPricing Strategy Matrix (Monthly Profit)")

	// Option 1: Use built-in formatter (simpler, basic formatting)
//	 let formatted = DataTable.formatTwoVariable(
//	     profitMatrix,
//	     rowInputs: pricePoints,
//	     columnInputs: volumeScenarios
//	 )
//	 print(formatted)

	// Option 2: Custom formatting with currency (shown below)
var header = "Price".padding(toLength: 10, withPad: " ", startingAt: 0)
	for volume in volumeScenarios {
		header += "\(Int(volume))".paddingLeft(toLength: 12)
	}
	print(header)
	print(String(repeating: "=", count: 70))

	for (rowIndex, price) in pricePoints.enumerated() {
		var rowString = "\(price.currency(0).padding(toLength: 10, withPad: " ", startingAt: 0))"
		for colIndex in 0..<volumeScenarios.count {
			let profit = profitMatrix[rowIndex][colIndex]
			rowString += "\(profit.currency(0).paddingLeft(toLength: 12))"
		}
		print(rowString)
	}

	// Find optimal combination
	var maxProfit = -Double.infinity
	var optimalPrice = 0.0
	var optimalVolume = 0.0

	for (rowIndex, price) in pricePoints.enumerated() {
		for (colIndex, volume) in volumeScenarios.enumerated() {
			let profit = profitMatrix[rowIndex][colIndex]
			if profit > maxProfit {
				maxProfit = profit
				optimalPrice = price
				optimalVolume = volume
			}
		}
	}

	print("\nOptimal Strategy:")
	print("Price: \(optimalPrice.currency()), Volume: \(optimalVolume.number(0)) units")
	print("Maximum Monthly Profit: \(maxProfit.currency())")


</code></pre></details>
<p>‚Üí Full API Reference: <a href="https://github.com/jpurnell/BusinessMath/blob/main/Sources/BusinessMath/BusinessMath.docc/2.1-DataTableAnalysis.md"><strong>BusinessMath Docs ‚Äì 2.1 Data Table Analysis</strong></a></p><p><strong>Modifications to try</strong>:</p><ol><li>Test loan affordability at different income levels</li><li>Create an investment NPV matrix with varying growth and discount rates</li><li>Build a product pricing table comparing different cost structures</li></ol><hr /><h2>Real-World Application</h2><p>A CFO analyzing capital equipment purchases needs to understand sensitivity to key assumptions:</p><ul><li><strong>Discount rate sensitivity</strong>: How does NPV change from 8% to 12%?</li><li><strong>Volume assumptions</strong>: What happens if production is 20% lower than expected?</li><li><strong>Price/volume trade-offs</strong>: Which combination maximizes profit?</li></ul><p>Data tables answer all these questions with 10-20 lines of code instead of complex spreadsheets.</p><hr /><h3>üìù Development Note</h3><p>When we first implemented data tables, we assumed users would want highly customized formatting. So we built a complex system with format strings, alignment options, and custom renderers.</p><p>It was too complicated.</p><p>The refactor was brutal: we deleted 300 lines of formatting code and replaced it with two simple functions: <code>toCSV()</code> and <code>formatTwoVariable()</code>. Users could export to CSV for Excel, or get basic console output. That‚Äôs it.</p><p><strong>The lesson</strong>: Don‚Äôt over-engineer formatting. Users either want raw data (CSV) or basic display (console). Everything in between is complexity they don‚Äôt need.</p><p><strong>Related Methodology</strong>: <a href="../week-05/02-tue-coding-standards.md">Coding Standards That Scale</a> (Week 5)</p><hr /><h2>Next Steps</h2><p><strong>Coming up next</strong>: Documentation as Design (Tuesday) - How writing docs before code reveals API flaws early.</p><p><strong>This week</strong>: We‚Äôll explore financial ratios (Wednesday) and risk analytics (Friday) to complete the Analysis Tools topic.</p><hr /><p><strong>Series Progress</strong>:</p><ul><li>Week: 2/12</li><li>Posts Published: 5/~48</li><li>Topics Covered: Foundation + Analysis Tools (starting)</li><li>Playgrounds: 5 available</li></ul></p><hr /><div style="margin-top: 2em"><p class="blurb" style="font-style: italic">Tagged with: businessmath, swift, data-tables, sensitivity-analysis, what-if</p></div></div></div><header><nav class="noPrint navbar navbar-expand-md" style="border-top: 0.01em solid #d5d5d5;"><div class="container-fluid col"><button type="button" class="navbar-toggler btn" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarCollapse" class="collapse navbar-collapse"><ul class="navbar-nav mb-2 mb-md-0 col"><li class="nav-item"><a href="mailto:morals.tech.0x@icloud.com" id="email" rel="me" target="_blank" class="nav-link">email</a></li><li class="nav-item"><a href="https://cal.com/jpurnell/15min" id="calendar" rel="me" target="_blank" class="nav-link">calendar</a></li><li class="nav-item"><a href="http://blog.justinpurnell.com" id="blog" rel="me" target="_blank" class="nav-link">blog</a></li><li class="nav-item"><a href="https://github.com/jpurnell" id="github" rel="me" target="_blank" class="nav-link">github</a></li><li class="nav-item"><a href="https://bsky.app/profile/justinpurnell.com" id="bsky" rel="me" target="_blank" class="nav-link">bsky</a></li><li class="nav-item"><a href="https://mastodon.social/@jpurnell" id="mastodon" rel="me" target="_blank" class="nav-link">mastodon</a></li><li class="nav-item"><a href="https://music.apple.com/us/station/justin-purnells-station/ra.u-a475786ae9cc432a1abb70ff757aa95f" id="radio" rel="me" target="_blank" class="nav-link">radio</a></li><li class="nav-item"><a href="https://www.justinpurnell.com/feed.rss" id="rss" rel="me" target="_blank" class="nav-link">rss</a></li><li class="nav-item"><a href="#" id="theme-toggle" rel="me" target="_blank" class="nav-link">theme</a></li></ul></div></div></nav></header><script src="/js/theme-toggle.js"></script></div><script src="/js/bootstrap.bundle.min.js"></script><script src="/js/syntax-highlighting.js"></script></body></html>