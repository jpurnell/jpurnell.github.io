<!doctype html><html lang="en" data-bs-theme="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Part 3 of 12-Week BusinessMath Series"><meta name="author" content="Justin Purnell"><meta name="generator" content="Ignite v0.2.1"><title>Time Series Foundation</title><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/prism-default-dark.css" rel="stylesheet"><link href="/css/bootstrap-icons.min.css" rel="stylesheet"><link href="https://www.justinpurnell.com/BusinessMath/week-01/03-wed-time-series" rel="canonical"><meta property="og:site_name" content="Justin Purnell"><meta property="og:title" content="Time Series Foundation"><meta property="twitter:title" content="Time Series Foundation"><meta property="og:description" content="Time Series Foundation"><meta name="twitter:description" content="Time Series Foundation"><meta property="og:url" content="https://www.justinpurnell.com/BusinessMath/week-01/03-wed-time-series"><meta name="twitter:domain" content="justinpurnell.com"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:dnt" content="on"><meta name="description" content="**Entrepreneurial Strategist & Builder:** Justin Purnell is the Founder of **Ledge Partners**, dedicated to acquiring and leading profitable businesses. His foundation is built on seven years at **Goldman Sachs** as a high yield credit analyst, where he published over **400 research reports** and advised C-level executives.
**Product Innovation and Scale:** He led the complete **re-platforming of technology supporting over 70 e-commerce sites** globally as Head of Product at **Hotels at Home**. He actively builds technical solutions, including pioneering **AI-powered software** to automate product data generation and designing a Swift middleware prototype that cut vendor onboarding time from **four months to two weeks**.
**Driving Financial and Organizational Results:** At **NBCUniversal's Seeso**, he directed product operations and retention initiatives that resulted in a **40% increase in customer Lifetime Value**. He is adept at mobilizing cross-functional teams, having successfully stepped in to **referee a dispute** between NBC and a third-party vendor to foster consensus and launch the Content Commerce platform.
**Creative and Governance Leadership:** Justin combines corporate rigor with creative experience, having directed the Webby-awarded web series **Smart Girls at the Party** and serving as a founding producer for **UCBcomedy.com**. He maintains significant governance roles, including serving as **President of the Princeton University Class of 2000** (1,143 alumni) and managing its annual giving campaigns."><meta name="fediverse:creator" content="@jpurnell@mastodon.social"><meta name="tags" content="Product Manager, Strategy, Product Leader, Goldman Sachs, NBCUniversal, Hotels at Home, AI, LLM, Digital Transformation, e-commerce, Swift, Consensus Leadership, Leadership, Agile, DevOps, Continuous Integration, Continuous Deployment, Cloud, Data Science, Machine Learning, Python, JavaScript, Front-end, Back-end, Full-stack, Responsive Design, Accessibility, SEO, Content Strategy, User Experience, User Interface, Design, Agile, Product Strategy, Technical Strategy"><script>	(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-K3TZS8J');</script><link href="/css/main.css" rel="stylesheet"></head><body><div class="col-sm-10 mx-auto"><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K3TZS8J"
	height="0" width="0" style="display:none;visibility:hidden"></iframe>
<header><nav class="noPrint navbar navbar-expand-md" style="border-bottom: 0.01em solid #d5d5d5;"><div class="container-fluid col"><button type="button" class="navbar-toggler btn" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarCollapse" class="collapse navbar-collapse"><ul class="navbar-nav mb-2 mb-md-0 col"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/about" class="nav-link">About</a></li><li class="nav-item"><a href="/cv" class="nav-link">CV</a></li><li class="nav-item"><a href="/business-math" class="nav-link">BusinessMath</a></li><li class="nav-item"><a href="/next" class="nav-link">NeXT</a></li></ul></div></div></nav></header><div class="row"><div class="col"><h1 class="mainTitle">Time Series Foundation</h1><div style="margin-bottom: 2em"><p class="blogDateTime" style="margin-left: 1em">BusinessMath Quarterly Series</p><p class="blogDateTime" style="margin-left: 1em">7 min read</p></div><p class="mx-auto blurb" style="width: 70%; max-width: 800px"><p><strong>Part 3 of 12-Week BusinessMath Series</strong></p><hr /><h2>What You‚Äôll Learn</h2><ul><li>How periods provide type-safe temporal identifiers</li><li>Period arithmetic and subdivision operations</li><li>Creating and manipulating time series data</li><li>Real-world time series workflows</li></ul><hr /><h2>The Problem</h2><p>Business data is inherently temporal. Revenue happens in months, quarters, and years. Stock prices change daily. Forecasts project into future periods.</p><p>But handling temporal data correctly is tricky. What happens when you add a month to January 31st? How do you align quarterly data with monthly data? How do you ensure you‚Äôre not accidentally comparing January 2024 revenue with January 2025?</p><p>Arrays with dates are fragile‚Äîindex mistakes are silent, type mixing goes undetected, and time arithmetic is error-prone. Getting the data model right requires a thoughtful execution and a better abstraction.</p><hr /><h2>The Solution</h2><p>BusinessMath provides <strong>Periods</strong> and <strong>TimeSeries</strong> for type-safe temporal data:</p><h3>Periods: Type-Safe Time Identifiers</h3><pre><code class="language-swift">import Foundation
import BusinessMath

// Create periods at different granularities
let jan2025 = Period.month(year: 2025, month: 1)
let q1_2025 = Period.quarter(year: 2025, quarter: 1)
let fy2025 = Period.year(2025)
let today = Period.day(Date())

// Period arithmetic
let feb2025 = jan2025 + 1          // Next month
let dec2024 = jan2025 - 1          // Previous month
let yearRange = jan2025...jan2025 + 11  // 12 months

// Distance between periods
let months = try jan2025.distance(to: Period.month(year: 2025, month: 6))
print("Months: \(months)")  // Output: 5
</code></pre><h3>Period Properties and Formatting</h3><pre><code class="language-swift">let period = Period.month(year: 2025, month: 3)

// Get boundary dates
let start = period.startDate  // March 1, 2025 00:00:00
let end = period.endDate      // March 31, 2025 23:59:59

// Built-in label
let label = period.label      // "2025-03"

// Custom formatting
let formatter = DateFormatter()
formatter.dateFormat = "MMMM yyyy"
let formatted = period.formatted(using: formatter)
print(formatted)  // Output: "March 2025"
</code></pre><h3>Period Subdivision</h3><p>Larger periods subdivide into smaller ones:</p><pre><code class="language-swift">// Year to quarters
let year = Period.year(2025)
let quarters = year.quarters()
// Result: [Q1 2025, Q2 2025, Q3 2025, Q4 2025]

// Year to months
let months = year.months()
// Result: [Jan 2025, Feb 2025, ..., Dec 2025]

// Quarter to months
let q1 = Period.quarter(year: 2025, quarter: 1)
let q1Months = q1.months()
// Result: [Jan 2025, Feb 2025, Mar 2025]

// Month to days (leap year aware)
let feb2024 = Period.month(year: 2024, month: 2)
let days = feb2024.days()
// Result: [Feb 1, Feb 2, ..., Feb 29]  (2024 is a leap year)
</code></pre><h3>Creating Time Series</h3><p>Associate values with periods:</p><pre><code class="language-swift">// From parallel arrays
let periods = [
    Period.month(year: 2025, month: 1),
    Period.month(year: 2025, month: 2),
    Period.month(year: 2025, month: 3)
]
let revenue: [Double] = [100_000, 120_000, 115_000]

let ts = TimeSeries(periods: periods, values: revenue)

// From dictionary
let data: [Period: Double] = [
    Period.month(year: 2025, month: 1): 100_000,
    Period.month(year: 2025, month: 2): 120_000,
    Period.month(year: 2025, month: 3): 115_000
]
let ts2 = TimeSeries(data: data)
</code></pre><h3>Working with Time Series</h3><pre><code class="language-swift">// Access by period
if let janRevenue = ts[periods[0]] {
    print("January: $\(janRevenue.formatted(.number))")
}

// Iterate over period-value pairs
for (period, value) in zip(periods, ts) {
	print("\(period.label): \(ts[period]!.currency())")
}
// Output:
// 2025-01: $100,000
// 2025-02: $120,000
// 2025-03: $115,000

// Get all values as array
let values = ts.valuesArray  // [100000.0, 120000.0, 115000.0]

// Get all periods
let allPeriods = ts.periods  // [Jan 2025, Feb 2025, Mar 2025]
</code></pre><hr /><h2>How It Works</h2><h3>Type-First Period Ordering</h3><p>Periods use a clever ordering strategy:</p><pre><code class="language-swift">let daily = Period.day(Date())
let monthly = Period.month(year: 2025, month: 1)
let quarterly = Period.quarter(year: 2025, quarter: 1)
let annual = Period.year(2025)

// Type comes before chronology
daily < monthly      // true (day < month in hierarchy)
monthly < quarterly  // true (month < quarter in hierarchy)
quarterly < annual   // true (quarter < year in hierarchy)

// Within same type, chronological order
Period.month(year: 2025, month: 1) < Period.month(year: 2025, month: 2)  // true
</code></pre><p>This prevents accidental mixing of granularities while maintaining intuitive ordering.</p><h3>Period Arithmetic Safety</h3><p>Period arithmetic is safe and predictable:</p><pre><code class="language-swift">// Adding months handles year boundaries
let dec2024 = Period.month(year: 2024, month: 12)
let jan2025 = dec2024 + 1  // Automatically ‚Üí January 2025

// Adding months handles varying lengths correctly
let jan31 = Period.day(DateComponents(year: 2025, month: 1, day: 31)!)
// Can't add "month" to day period - compile error!
// Must work at month granularity:
let janMonth = Period.month(year: 2025, month: 1)
let febMonth = janMonth + 1  // ‚Üí February 2025
</code></pre><hr /><h2>Try It Yourself</h2><details>
<summary>Click to expand full playground code</summary>
<pre><code class="language-swift">import BusinessMath

// Create periods at different granularities
let jan2025 = Period.month(year: 2025, month: 1)
let q1_2025 = Period.quarter(year: 2025, quarter: 1)
let fy2025 = Period.year(2025)
let today = Period.day(Date())

// Period arithmetic
let feb2025 = jan2025 + 1          // Next month
let dec2024 = jan2025 - 1          // Previous month
let yearRange = jan2025...jan2025 + 11  // 12 months

// Distance between periods
//let months = try jan2025.distance(to: Period.month(year: 2025, month: 6))
//print("Months: \(months)")  // Output: 5

let period = Period.month(year: 2025, month: 3)

// Get boundary dates
let start = period.startDate  // March 1, 2025 00:00:00
let end = period.endDate      // March 31, 2025 23:59:59

// Built-in label
let label = period.label      // "2025-03"

// Custom formatting
let formatter = DateFormatter()
formatter.dateFormat = "MMMM yyyy"
let formatted = period.formatted(using: formatter)
print(formatted)  // Output: "March 2025"

	// Year to quarters
	let year = Period.year(2025)
	let quarters = year.quarters()
	// Result: [Q1 2025, Q2 2025, Q3 2025, Q4 2025]

	// Year to months
	let months = year.months()
	// Result: [Jan 2025, Feb 2025, ..., Dec 2025]

	// Quarter to months
	let q1 = Period.quarter(year: 2025, quarter: 1)
	let q1Months = q1.months()
	// Result: [Jan 2025, Feb 2025, Mar 2025]

	// Month to days (leap year aware)
	let feb2024 = Period.month(year: 2024, month: 2)
	let days = feb2024.days()
	// Result: [Feb 1, Feb 2, ..., Feb 29]  (2024 is a leap year)

	// From parallel arrays
	let periods = [
		Period.month(year: 2025, month: 1),
		Period.month(year: 2025, month: 2),
		Period.month(year: 2025, month: 3)
	]
	let revenue: [Double] = [100_000, 120_000, 115_000]

	let ts = TimeSeries(periods: periods, values: revenue)

	// From dictionary
	let data: [Period: Double] = [
		Period.month(year: 2025, month: 1): 100_000,
		Period.month(year: 2025, month: 2): 120_000,
		Period.month(year: 2025, month: 3): 115_000
	]
	let ts2 = TimeSeries(data: data)

	// Access by period
	if let janRevenue = ts[periods[0]] {
		print("January: $\(janRevenue.formatted(.number))")
	}


	// Iterate over period-value pairs
	for (period, value) in zip(periods, ts) {
		print("\(period.label): \(ts[period]!.currency())")
	}
	// Output:
	// 2025-01: $100,000
	// 2025-02: $120,000
	// 2025-03: $115,000

	// Get all values as array
	let values = ts.valuesArray  // [100000.0, 120000.0, 115000.0]

	// Get all periods
	let allPeriods = ts.periods  // [Jan 2025, Feb 2025, Mar 2025]

	// Monthly revenue data
	let monthlyRevenue = TimeSeries(
		periods: (1...12).map { Period.month(year: 2024, month: $0) },
		values: [100, 105, 110, 108, 115, 120, 118, 125, 130, 128, 135, 140]
	)

	// Group into quarters
	let q1Monthss = Period.quarter(year: 2024, quarter: 1).months()
	let q1Revenue = q1Monthss.compactMap { monthlyRevenue[$0] }.reduce(0, +)
	print("Q1 Revenue: \(q1Revenue.currency(0))")  // $315K

</code></pre></details>
<p>‚Üí Full API Reference: <a href="https://github.com/jpurnell/BusinessMath/blob/main/Sources/BusinessMath/BusinessMath.docc/1.2-TimeSeries.md"><strong>BusinessMath Docs ‚Äì Time Series Analysis</strong></a></p><p><strong>Modifications to try</strong>:</p><ol><li>Create a time series for quarterly revenue and subdivide to monthly</li><li>Calculate the distance between two periods in different years</li><li>Build a time series from Q1 2024 to Q4 2025 (8 quarters)</li></ol><hr /><h2>Real-World Application</h2><p>Financial analysts work with time series constantly. Internal revenue data may come monthly, but executives want quarterly summaries. Historical analysis might span years, but forecasts may project only 3 or 6 months.</p><p>Period subdivision makes aggregation simple:</p><pre><code class="language-swift">// Monthly revenue data
let monthlyRevenue = TimeSeries(
    periods: (1...12).map { Period.month(year: 2024, month: $0) },
    values: [100, 105, 110, 108, 115, 120, 118, 125, 130, 128, 135, 140]
)

// Group into quarters
let q1Months = Period.quarter(year: 2024, quarter: 1).months()
let q1Revenue = q1Months.compactMap { monthlyRevenue[$0] }.reduce(0, +)
print("Q1 Revenue: \(q1Revenue.currency(0))")  // $315K
</code></pre><hr /><h3>üìù Development Note</h3><p>During development of the time series functionality, we discovered that multiple statistical formulas have different variants. For example, there are at least three common definitions of ‚Äúexponential moving average.‚Äù</p><p>Without explicit documentation of <em>which</em> variant we chose, tests would pass but results wouldn‚Äôt match external tools like Excel, which is the defacto standard for the financial community. This led to a practice: when implementing any algorithm with multiple valid interpretations, we document the exact formula in both the code and DocC.</p><p>‚ÄúAI will confidently implement <em>a</em> version of the algorithm. Your job is to ensure it‚Äôs the <em>right</em> version for your use case.‚Äù</p><p>The fix: Include the formula in the test itself:</p><pre><code class="language-swift">@Test("EMA uses alpha = 2/(window+1) formula")
func testEMAFormula() {
    let prices = [10.0, 11.0, 12.0, 11.5, 13.0]
    let ema = calculateEMA(values: prices, window: 3)

    // Explicitly verify formula: EMA(t) = Œ±√óP(t) + (1-Œ±)√óEMA(t-1)
    // where Œ± = 2 / (3 + 1) = 0.5
    let expected = 12.25  // Calculated manually with this formula
    #expect(abs(ema.last! - expected) < 0.01)
}
</code></pre><p>This test not only verifies correctness but documents which variant we‚Äôre using.</p><p><strong>Related Methodology</strong>: <a href="../../week-02/02-tue-documentation-as-design">Documentation as Design</a> (Week 2)</p><hr /><h2>Next Steps</h2><p><strong>Coming up next</strong>: Friday‚Äôs case study combines Time Series with Time Value of Money to build a retirement planning calculator.</p><p><strong>Case Study #1</strong>: <a href="../04-fri-case-retirement">Retirement Planning Calculator (Friday)</a> - See time series and TVM working together to answer real business questions.</p><hr /><p><strong>Series Progress</strong>:</p><ul><li>Week: 1/12</li><li>Posts Published: 3/~48</li><li>Case Studies: 0/6</li><li>Topics Covered: Getting Started, Test-First Development, Time Series</li><li>Playgrounds: 2 available</li></ul></p><hr /><div style="margin-top: 2em"><p class="blurb" style="font-style: italic">Tagged with: businessmath, swift, time-series, periods, temporal-data</p></div></div></div><header><nav class="noPrint navbar navbar-expand-md" style="border-top: 0.01em solid #d5d5d5;"><div class="container-fluid col"><button type="button" class="navbar-toggler btn" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div id="navbarCollapse" class="collapse navbar-collapse"><ul class="navbar-nav mb-2 mb-md-0 col"><li class="nav-item"><a href="mailto:morals.tech.0x@icloud.com" id="email" rel="me" target="_blank" class="nav-link">email</a></li><li class="nav-item"><a href="https://cal.com/jpurnell/15min" id="calendar" rel="me" target="_blank" class="nav-link">calendar</a></li><li class="nav-item"><a href="http://blog.justinpurnell.com" id="blog" rel="me" target="_blank" class="nav-link">blog</a></li><li class="nav-item"><a href="https://github.com/jpurnell" id="github" rel="me" target="_blank" class="nav-link">github</a></li><li class="nav-item"><a href="https://bsky.app/profile/justinpurnell.com" id="bsky" rel="me" target="_blank" class="nav-link">bsky</a></li><li class="nav-item"><a href="https://mastodon.social/@jpurnell" id="mastodon" rel="me" target="_blank" class="nav-link">mastodon</a></li><li class="nav-item"><a href="https://music.apple.com/us/station/justin-purnells-station/ra.u-a475786ae9cc432a1abb70ff757aa95f" id="radio" rel="me" target="_blank" class="nav-link">radio</a></li><li class="nav-item"><a href="http://blog.justinpurnell.com/rss" id="rss" rel="me" target="_blank" class="nav-link">rss</a></li><li class="nav-item"><a href="#" id="theme-toggle" rel="me" target="_blank" class="nav-link">theme</a></li></ul></div></div></nav></header><script src="/js/theme-toggle.js"></script></div><script src="/js/bootstrap.bundle.min.js"></script><script src="/js/syntax-highlighting.js"></script></body></html>